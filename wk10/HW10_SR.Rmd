---
title: "Homework 10"
author: "Sam Reeves"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Smith is in jail and has 1 dollar; he can get out on bail if he has 8 dollars.  A guard agrees to make a series of bets with him. If Smith bets A dollars, he wins A dollars with probability .4 and loses A dollars with probability .6.

## Find the probability that he wins 8 dollars before losing all of his money if:

>(a) he bets 1 dollar each time (timid strategy).


\[P = \bigg( \begin{array}{cc}
  Q & R \\
  0 & I \\ \end{array}\bigg)\]
  
\[N = (I - Q)^{-1}\]

\[B = N R\]

```{r}
library(markovchain)

p <- 2/5
q <- 1 - p

absorbing_chain_probabilities <- function(m) {
  m <- new('markovchain',
         transitionMatrix = m,
         states = colnames(m))
  
  P <- as(canonicForm(m), "matrix")
  P_matrix <- as(P, "matrix")

  r <- as.numeric(unlist(absorbingStates(m)))
  r.l <- length(r)
  
  t <- as.numeric(unlist(transientStates(m)))
  t.l <- length(t)
  
  
  Q <- P_matrix[(r.l+1):(r.l+t.l),(r.l+1):(r.l+t.l)]
  I <- diag(7)

  N <-  solve(I - Q)
  R <- P_matrix[3:9, 1:2]

  B <- N %*% R
  return(B)
}


(m <- matrix(c(1, rep(0, 8),
              q, 0, p, rep(0, 6),
              0, q, 0, p, rep(0, 5),
              rep(0, 2), q, 0, p, rep(0, 4),
              rep(0, 3), q, 0, p, rep(0, 3),
              rep(0, 4), q, 0, p, rep(0, 2),
              rep(0, 5), q, 0, p, 0,
              rep(0,6), q, 0, p,
              rep(0,8), 1), nrow = 9, byrow = TRUE,
            dimnames = list(c(0:8), c(0:8))))

absorbing_chain_probabilities(m)
```


The probability of getting to \$8 from \$1 with this strategy is $\approx 0.0203$.

>(b) he bets, each time, as much as possible but not more than necessary to bring his fortune up to 8 dollars (bold strategy).

```{r}
(m <- matrix(c(1, rep(0,8),
              q, 0, p, rep(0,6),
              q, rep(0,3), p, rep(0,4),
              q, rep(0,5), p, rep(0,2),
              q, rep(0,7), p,
              rep(0,2), q, rep(0,5), p,
              rep(0,4), q, rep(0,3), p,
              rep(0,6), q, 0, p,
              rep(0,8), 1),
            nrow = 9, byrow = TRUE,
            dimnames = list(c(0:8), c(0:8))))

absorbing_chain_probabilities(m)
```

The probability of getting to \$8 from \$1 with this strategy is $\approx 0.064$.

>(c) Which strategy gives Smith the better chance of getting out of jail?

The adaptive strategy gives a better chance because the risk of going to \$0 in the same number of bets that got you to your current amount is gone after you get past winning amount divided by two!